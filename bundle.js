(()=>{"use strict";var t=function(t,e,n,o){return new(n||(n=Promise))((function(r,c){function u(t){try{a(o.next(t))}catch(t){c(t)}}function i(t){try{a(o.throw(t))}catch(t){c(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(u,i)}a((o=o.apply(t,e||[])).next())}))};const e=document.getElementById("portfolioForm"),n=document.getElementById("startDate"),o=document.getElementById("stockSymbol"),r=document.getElementById("monthsQuantity"),c=document.getElementById("investmentAmount"),u=document.getElementById("resultTable");function i(t,e){const n=e.findIndex((e=>e>t)),o=n-1;return e[n]-t>t-e[o]?o:n}function a(t,e){const n=new Date(t);return n.setMonth(n.getMonth()+e)}function l(t){return Math.floor(t/1e3)}e.addEventListener("submit",(function(e){return t(this,void 0,void 0,(function*(){e.preventDefault();const s=yield function(e,n,o){return t(this,void 0,void 0,(function*(){const t=new Date(n).getTime(),r=new Date(a(t,o)),c=l(t),u=l(r.getTime()),i=`https://query1.finance.yahoo.com/v8/finance/chart/${e}?period1=${c}&period2=${u}&interval=1d`,s=yield fetch(i);return yield s.json()}))}(o.value,n.value,+r.value),d=s.chart.result[0].indicators.quote[0],f=s.chart.result[0].timestamp,m=function(t,e){const n=[],o=1e3*t[0];for(let r=0;r<e;r++){const e=i(l(a(o,r)),t);n.push(e)}return n}(f,+r.value),h=function(t,e,n,o){return t.reduce(((t,r,c)=>{const u=new Date(1e3*e[r]),i=n.close[r],a=o/i,l=t[c].stocksTotal+a,s=l*i,d=o*(c+1);return t.push({date:u.toLocaleDateString("en-US"),price:i,investedTotal:d,stocksTotal:l,portfolioTotal:s,percentTotal:s-d}),t}),[{date:null,price:0,stocksTotal:0,investedTotal:0,percentTotal:0,portfolioTotal:0}]).slice(1)}(m,f,d,+c.value);!function(t,e){const n=function(t){return`<thead>${Object.keys(t[0]).map((t=>`<th>${t}</th>`)).join("")}</thead>`}(e),o=function(t){let e="";return t.forEach((t=>{const n=Object.keys(t).map((e=>{return`<td>${n=t[e],"number"==typeof n?(Math.round(100*n)/100).toString():n}</td>`;var n}));e+=`<tr>${n.join("")}</tr>`})),`<tbody>${e}</tbody>`}(e);t.innerHTML=n+o}(u,h)}))}))})();